This is an algo for version 1.